# x64 assembly

## Intel記法
x64アセンブリにはIntel記法とAT&T記法の二種類が存在している. 
AT&T記法ではオペランドの順番が非直感的(と感じる)なので主にIntel記法について説明する.

Intel記法を用いるにはアセンブリの初めに 
```
.intel_syntax
```
と書く. 

## 流れ
実際にアセンブリを書いて手を動かさないと理解できないと思われるため, 手を動かして覚えるようにする. そのためには実行結果が見えるようにしたい. そのため適当な整数ひとつを出力する関数だけ実行できるようにする. 

```asm
.intel_syntax noprefix

.section .data
number_format:
    .ascii "%d\n"

.global main, print_one_integer
.section .text

print_one_integer:
    mov rsi, rdi # Integer
    lea rdi, [rip + number_format] # Pointer to a format string
    call printf
    ret

main:
    mov rsi, 5
    mov rdi, 6
    add rdi, rsi
    call print_one_integer
    ret
```

`./do sample.s` を実行すると, 最後の行に `11` が出力されればよい. 
`print_one_integer` は第一引数(`rdi`)に整数をセットしてから呼ぶとそれを出力してくれる. libとリンクしてprintfを利用することで出力を行う. 

## 算術演算

## データ移動

## ジャンプ

## Ref
- [x64_cheetsheet](https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf)
    - x64全体をつかむため見た. 
- [低レイヤを知りたい人のためのCコンパイラ作成入門](https://www.sigbus.info/compilerbook)